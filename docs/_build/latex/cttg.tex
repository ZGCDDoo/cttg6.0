%% Generated by Sphinx.
\def\sphinxdocclass{report}
\documentclass[letterpaper,10pt,english]{sphinxmanual}
\ifdefined\pdfpxdimen
   \let\sphinxpxdimen\pdfpxdimen\else\newdimen\sphinxpxdimen
\fi \sphinxpxdimen=49336sp\relax

\usepackage[margin=1in,marginparwidth=0.5in]{geometry}
\usepackage[utf8]{inputenc}
\ifdefined\DeclareUnicodeCharacter
  \DeclareUnicodeCharacter{00A0}{\nobreakspace}
\fi
\usepackage{cmap}
\usepackage[T1]{fontenc}
\usepackage{amsmath,amssymb,amstext}
\usepackage{babel}
\usepackage{times}
\usepackage[Bjarne]{fncychap}
\usepackage{longtable}
\usepackage{sphinx}

\usepackage{multirow}
\usepackage{eqparbox}

% Include hyperref last.
\usepackage{hyperref}
% Fix anchor placement for figures with captions.
\usepackage{hypcap}% it must be loaded after hyperref.
% Set up styles of URL: it should be placed after hyperref.
\urlstyle{same}

\addto\captionsenglish{\renewcommand{\figurename}{Fig.\@ }}
\addto\captionsenglish{\renewcommand{\tablename}{Table }}
\addto\captionsenglish{\renewcommand{\literalblockname}{Listing }}

\addto\extrasenglish{\def\pageautorefname{page}}

\setcounter{tocdepth}{0}



\title{cttg Documentation}
\date{Jan 17, 2018}
\release{3.0.1}
\author{Charles-David Hebert, Maxime Charlebois, Patrick Semon}
\newcommand{\sphinxlogo}{}
\renewcommand{\releasename}{Release}
\makeindex

\begin{document}

\maketitle
\sphinxtableofcontents
\phantomsection\label{\detokenize{index::doc}}



\chapter{Introduction}
\label{\detokenize{intro:welcome-to-cttg-s-documentation}}\label{\detokenize{intro:introduction}}\label{\detokenize{intro::doc}}
cttg stands for \sphinxstyleemphasis{Continuous time Tremblay group}
and regroups two main Continuous-time quantum monte-carlo algorithms, namely CT-INT and CT-AUX.


\section{Warning: Bad Docs}
\label{\detokenize{intro:warning-bad-docs}}
The documentation has only been started very recently. It is thus full of language errors, probably wrong at certain places and of poor quality.
However, the quality will increase overtime.


\section{Conventions}
\label{\detokenize{intro:conventions}}

\subsection{Comments}
\label{\detokenize{intro:comments}}\begin{description}
\item[{We use the convention ``\$'' for the start of a shell command and ``\#'' for commenting shell commands, etc.}] \leavevmode\begin{description}
\item[{Ex:}] \leavevmode
\$ cd path/to/thing    \# change to the path of thing.

\end{description}

\end{description}


\subsection{Executable names}
\label{\detokenize{intro:executable-names}}
When not specified, the algorithm is CT-INT. if there is ``aux'' in the name, then CT-AUX.
If ``sub'' in name, then submatrix algorithm, else normal fast-update scheme.


\subsection{Hamiltonian}
\label{\detokenize{intro:hamiltonian}}\begin{equation*}
\begin{split}H = + \sum_{ij} t_{ij} + U \sum_{i} n_{i \uparrow} n_{i \downarrow}\end{split}
\end{equation*}
Thus, for the cuprates, the convention of the program is
\begin{itemize}
\item {} 
t = -1.0

\item {} 
t' = 0.3

\item {} 
t'' = -0.2

\end{itemize}


\chapter{Installation}
\label{\detokenize{installation:installation}}\label{\detokenize{installation:id1}}\label{\detokenize{installation::doc}}

\section{Dependencies}
\label{\detokenize{installation:dependencies}}\begin{enumerate}
\item {} 
Armadillo

\item {} 
boost (mpi, serialization, filesystem, system)

\end{enumerate}


\section{Pre-Steps}
\label{\detokenize{installation:pre-steps}}\begin{enumerate}
\item {} 
Make sure you have a ``bin'' directory in your home folder

\item {} 
Append the bin folder to your path. Add the following line to your \textasciitilde{}/.bashrc:  export PATH=''\$PATH:\textasciitilde{}/bin''

\item {} 
\$ source \textasciitilde{}/.bashrc

\end{enumerate}


\section{Linux (Ubuntu 16.04)}
\label{\detokenize{installation:linux-ubuntu-16-04}}
This installation procedure should work for many recent Linux flavors. For the following
we present the instructions specific for Ubuntu or derivatives.
\begin{enumerate}
\item {} \begin{description}
\item[{Install the Dependencies}] \leavevmode
\$ sudo apt-get install libarmadillo-dev libboost-all-dev

\end{description}

\item {} 
\begin{DUlineblock}{0em}
\item[] \$ mkdir build \&\& cd build \&\& cmake -DTEST=OFF .. \&\& make -j NUMBER\_OF\_CORES install
\item[] \# replace NUMBER\_OF\_CORE by say = 4
\end{DUlineblock}

\end{enumerate}


\section{Mac}
\label{\detokenize{installation:mac}}
This has not been tested yet, works?
\begin{enumerate}
\item {} \begin{description}
\item[{Install the Dependencies}] \leavevmode
\$ homebrew install armadillo boost

\end{description}

\item {} 
\begin{DUlineblock}{0em}
\item[] \$ mkdir build \&\& cd build \&\& cmake -DHOME=OFF -DMAC=ON  .. \&\& make -j NUMBER\_OF\_CORES install
\item[] \# replace NUMBER\_OF\_CORE by say = 4
\end{DUlineblock}

\end{enumerate}


\section{Mp2}
\label{\detokenize{installation:mp2}}\begin{enumerate}
\item {} 
\$ module reset

\item {} 
\$ module load cmake/3.6.1  gcc/6.1.0  intel64/17.4  boost64/1.65.1\_intel17 openmpi/1.8.4\_intel17  armadillo/8.300.0

\item {} 
\$ mkdir build \&\& cd build \&\& cmake -DHOME=OFF -DMP2=ON -DMPI\_BUILD=ON .. \&\& make install

\end{enumerate}


\section{Graham and Ceder}
\label{\detokenize{installation:graham-and-ceder}}\begin{enumerate}
\item {} 
\$ module reset

\item {} 
\$ module load nixpkgs/16.09  gcc/5.4.0 armadillo boost-mpi

\item {} 
\begin{DUlineblock}{0em}
\item[] \$ mkdir build \&\& cd build \&\& \textbackslash{}
\item[] cmake -DHOME=OFF -DGRAHAM=ON -DMPI\_BUILD=ON  .. \&\& make install
\end{DUlineblock}

\end{enumerate}
\phantomsection\label{\detokenize{tutorial:tutorial}}

\chapter{Tutorial}
\label{\detokenize{tutorial:id1}}\label{\detokenize{tutorial::doc}}

\section{Graham: Tutorial 1}
\label{\detokenize{tutorial:graham-tutorial-1}}\begin{enumerate}
\item {} 
\begin{DUlineblock}{0em}
\item[] Connect to Graham:
\item[] \$ ssh -X ``user''@graham.computecanada.ca \# where ``user'' is your compute canada/Mp2 Username
\end{DUlineblock}

\item {} 
Ensure you have done the Pre-Steps described in {\hyperref[\detokenize{installation:installation}]{\sphinxcrossref{\DUrole{std,std-ref}{Installation}}}}.

\item {} \begin{description}
\item[{Start an interactive job:}] \leavevmode
\$ salloc  --time=01:00:00 --ntasks=1 --mem-per-cpu=4000

\end{description}

\item {} 
Follow th Graham Procedure in {\hyperref[\detokenize{installation:installation}]{\sphinxcrossref{\DUrole{std,std-ref}{Installation}}}}.

\item {} 
\$ cd examples/Graham

\item {} 
\$ module reset

\item {} 
\$ module load nixpkgs/16.09  gcc/5.4.0 armadillo boost-mpi

\item {} 
\$ cd examples/CDMFT

\item {} 
\$ cdmft\_square4x4 params 1

\end{enumerate}


\section{Home}
\label{\detokenize{tutorial:home}}

\subsection{Home: Tutorial 1 = dmft}
\label{\detokenize{tutorial:home-tutorial-1-dmft}}
To Come. For now, go into the ``examples folder'', select your installation and run the bash script.
If there are some problems, then install ``dos2unix'' and run it on the bash files.
\begin{quote}

\$dos2unix runCDMFT
\end{quote}
\begin{description}
\item[{Ex:}] \leavevmode
If you installed on your computer
1. \$ cd examples/Home
2. \$ bash runCDMFT.sh \# in fact runs dmft

\end{description}


\subsection{Home: tutorial 2 = cdmft\_square4x4}
\label{\detokenize{tutorial:home-tutorial-2-cdmft-square4x4}}\begin{enumerate}
\item {} 
\$ cd examples/CDMFT

\item {} \begin{description}
\item[{copy the script file, for example if on Home:}] \leavevmode
\$ cp ../Home/runCDMFT ./

\end{description}

\item {} \begin{description}
\item[{in ``runCDMFT'', replace the line:}] \leavevmode
myExe=dmft  -\textgreater{} myExe=cdmft\_square4x4

\end{description}

\item {} 
\$ bash runCDMFT

\end{enumerate}


\subsection{Launching a simulation}
\label{\detokenize{tutorial:launching-a-simulation}}
To launch a simulation, you need three files:
\begin{enumerate}
\item {} 
a script file, dependant on the platform (home, mp2, graham-cedar)

\item {} 
a ``params'' file (Ex: params1.json)

\item {} 
a ``hyb'' file (Ex: hyb1.arma)

\end{enumerate}


\section{When to use which algorithm}
\label{\detokenize{tutorial:when-to-use-which-algorithm}}
CT-Aux and CT-INT behave in a similar manner, and from my experience, one is not much faster than the other.

Cocerning Submatrix Updates, the codes ''...\_sub'' should be used when the expansion order is high, say k\textgreater{}1000
For k\textasciitilde{}\textless{}500, the algorithm may be slower.
\begin{description}
\item[{Ex:}] \leavevmode
cdmft\_square4x4 for k \textless{} 1000
cdmft\_square4x4\_int\_sub for k \textgreater{} 1000

\end{description}


\chapter{The params file}
\label{\detokenize{params:the-params-file}}\label{\detokenize{params::doc}}

\section{Fast-Update Scheme}
\label{\detokenize{params:fast-update-scheme}}

\subsection{Main Paremeters}
\label{\detokenize{params:main-paremeters}}
The following parameters are the ones that the user has to change and need to understand. There is a bit of unconsistency, to be corrected
(some are lower case, while other are upper case.)
\begin{quote}
\begin{description}
\item[{SEED}] \leavevmode
the seed for the random number generator.

\item[{PROBFLIP}] \leavevmode
the ratio of updates that are spin flips for the Auxiliary spins. Should be bewteen 0.0 and 0.2. 0.1 is reasonable.
A non zero number will help the convergence speed.

\item[{beta}] \leavevmode
inverse temperature

\item[{NMAT}] \leavevmode
the cutoff of matsubara frequencies in energy, 100 is fine

\item[{NTAU}] \leavevmode
the time discretization for G(tau) and for binning measurements. Normally
a value of 1000 is sufficient, but, for low temperatures and big NMAT,
a higher value is neccessary to get unbiaised results.

\item[{UPDATESMEAS}] \leavevmode
The numbre of Updates proposed bewteen each measurement.
This value should be approximately equal to the average expansion order.
Updates proposed bewteen measurements = UPDATESMEAS

\item[{THERMALIZATION\_TIME}] \leavevmode
the time for which each processor will thermalize. It is difficult to give a good
optimal value. I would say, \textasciitilde{}10\% of the measurement time.

\item[{MEASUREMENT\_TIME}] \leavevmode
The time each processor measures.

\item[{PRECISE}] \leavevmode
If set to true, then the measure of the green function is more precise, but slower. Should be generally set to false,
unless analytic continuation is neccessary. Even then, the solution should be converged before setting to `true'

\end{description}
\end{quote}


\subsection{Implementation detailed Parameters}
\label{\detokenize{params:implementation-detailed-parameters}}
These parameters can be left at their current value, i.e they are implementation details.
Make sure you understand what you are doing before changing them.
\begin{quote}
\begin{description}
\item[{CLEANUPDATE}] \leavevmode
Specifies when to perform a clean update. Ex, if =100, than at each
100 measures, a cleanupdate will be performed. 100 is a good number.
does not substantially influence the simulation, except if this number is to low or to high.
``K'': The value of the K parameter of CT-Aux. Influences the acceptance rate and the expansion order
1 seems a reasanable value

\item[{THERM\_FROM\_CONFIG}] \leavevmode
if true, there will be no thermalization, the last saved configuartion will be loaded
and the measurements will start. Not really tested yet. So the default is false.
André-Marie argues that it is better to thermalize each time.

\item[{n}] \leavevmode
If this parameter is in the params file, than the program will change the chemical potential to attain the given value.

\end{description}
\end{quote}


\section{Submatrix Update Scheme}
\label{\detokenize{params:submatrix-update-scheme}}
For the \sphinxstyleemphasis{Submatrix} algorithm, only one parameter has a differnet meaning than in the ``Normal'' fast-update algorithm, it is the UPDATESMEAS
parameter.
\begin{quote}
\begin{description}
\item[{UPDATESMEAS}] \leavevmode
For the Submatrix update scheme, the number of updates proposed
bewteen each measurement is given by this parameter multipled by KMAX\_UPD. I.E:
submatrix scheme: Updates proposed bewteen measurements = UPDATESMEAS * KMAX\_UPD.
For exemple, if the average expansion order is k = 1000, than you should set something like:
KMAX\_UPD = 100, UPDATESMEAS = 10.

\item[{KMAX\_UPD}] \leavevmode
the maximum number of updates proposed for each internal iteration (implementation details).
This parameter should be \textasciitilde{}100 on MP2, \textasciitilde{}125 on Graham, and has a different optimal value for different architectures.

\end{description}
\end{quote}



\renewcommand{\indexname}{Index}
\printindex
\end{document}